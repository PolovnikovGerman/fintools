// JavaScript Document

var xmlhttp;
function add_task(area,live)
{

	var type=area;
	var msg=document.getElementById("task_msg").value; 
	
	if(msg.substring(0,1) == '^'){ type = 'head'; msg=msg.substring(1);  } else { type = 'task'; }
	var cat=document.getElementById("task_cat").value;

	 msg = msg.replace('#','%23');
	 msg = msg.replace('&','%26');
	 msg = msg.replace('+','%2b');
xmlhttp=GetXmlHttpObject();
if (xmlhttp==null)
  {
  alert ("Browser does not support HTTP Request");
  return;
  }
var url="task_ajax_return.php";
url=url+"?q=add_task&msg="+msg+"&cat="+cat+"&type="+type+"&live="+live; 
url=url+"&sid="+Math.random();
xmlhttp.onreadystatechange=add_task_return;
xmlhttp.open("GET",url,true);
xmlhttp.send(null);
}
function add_task_return()
{

if (xmlhttp.readyState==4)
{
	
document.getElementById("task_area").innerHTML=xmlhttp.responseText;	
document.getElementById("task_msg").value='';
document.getElementById("task_msg").focus();

}
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////Update task/////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
var ret_area;

function update_task(taskid,area,index)
{
ret_area = area+'tasks'+index;
var msg=document.getElementById('task_msg'+area+index).value;  

     msg = msg.replace('#','%23');
	 msg = msg.replace('&','%26');
	 msg = msg.replace('+','%2b');
xmlhttp=GetXmlHttpObject();
if (xmlhttp==null)
  {
  alert ("Browser does not support HTTP Request");
  return;
  }
var url="task_ajax_return.php";
url=url+"?q=update_task&taskid="+taskid+"&msg="+msg; 
url=url+"&sid="+Math.random();
xmlhttp.onreadystatechange=update_task_return;
xmlhttp.open("GET",url,true);
xmlhttp.send(null);
}
function update_task_return()
{

if (xmlhttp.readyState==4)
{
document.getElementById(ret_area).innerHTML=xmlhttp.responseText;	
}
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////MOVE TASK/////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function move_task( pos, curr, sec,  iid,live)
{
	var cat=document.getElementById('task_cat').value;
if(pos!= 0) {

	xmlhttp=GetXmlHttpObject();
		if (xmlhttp==null)
  		{
  			alert ("Browser does not support HTTP Request");
  			return;
  		}
		var url="task_ajax_return.php";
		url=url+"?q=change_order&pos="+pos+"&curr="+curr+"&sec="+sec+"&iid="+iid+"&cat="+cat+"&live="+live; 
		url=url+"&sid="+Math.random();
		xmlhttp.onreadystatechange=stateChanged5;
		xmlhttp.open("GET",url,true);
		xmlhttp.send(null);
}
}

function stateChanged5()
{

if (xmlhttp.readyState==4)
{
	
document.getElementById("task_area").innerHTML=xmlhttp.responseText;

}
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////MOVE TASK ACTIVE/////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function move_task_active( pos, curr, sec,  iid)
{
var cat=document.getElementById('task_cat').value;	
if(pos!= 0) {

	xmlhttp=GetXmlHttpObject();
		if (xmlhttp==null)
  		{
  			alert ("Browser does not support HTTP Request");
  			return;
  		}
		var url="task_ajax_return.php";
		url=url+"?q=change_order&pos="+pos+"&curr="+curr+"&sec="+sec+"&iid="+iid+"&cat="+cat; 
		url=url+"&sid="+Math.random();
		xmlhttp.onreadystatechange=stateChanged6;
		xmlhttp.open("GET",url,true);
		xmlhttp.send(null);
}
}

function stateChanged6()
{

if (xmlhttp.readyState==4)
{
	
document.getElementById("active_area").innerHTML=xmlhttp.responseText;

}
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function close_task(taskid,secid, x, live)
{
	var cat=document.getElementById('task_cat').value;
if(document.getElementById("close"+x).checked = true)
{ 
	xmlhttp=GetXmlHttpObject();
		if (xmlhttp==null)
  		{
  			alert ("Browser does not support HTTP Request");
  			return;
  		}
		var url="task_ajax_return.php";
		url=url+"?q=close_task&taskid="+taskid+"&secid="+secid+"&cat="+cat+"&live="+live; 
		url=url+"&sid="+Math.random();
		xmlhttp.onreadystatechange=closetask;
		xmlhttp.open("GET",url,true);
		xmlhttp.send(null);
}
}

function closetask()
{

if (xmlhttp.readyState==4)
{	
	//alert(xmlhttp.responseText);
//	var theResponse = xmlHttp.responseText.split('@');
//document.getElementById('task_area').innerHTML = theResponse[0];
//document.getElementById('active_area').innerHTML = theResponse[1];
	//alert(xmlhttp.responseText);
	//document.getElementById("task_area").innerHTML="Can you hear me now?"; 
	
	try{
	var theResponse = JSON.parse(xmlhttp.responseText); 
	}
	catch(err)
	{
	alert("Error in JSON response format");	
	}
	document.getElementById('task_area').innerHTML = theResponse.firstResponse; 
	document.getElementById('active_area').innerHTML = theResponse.secondResponse;
}
}

//////////////////////////////////////////////////////////////////////////////////////MOVE TASK/////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function make_task_active( taskid,  tasktype)
{
	var taskcat=document.getElementById('task_cat').value;
	var tsec = document.getElementById("get_tsec").value;
if(tsec != '') {

	xmlhttp=GetXmlHttpObject();
		if (xmlhttp==null)
  		{
  			alert ("Browser does not support HTTP Request");
  			return;
  		}
		var url="task_ajax_return.php";
		url=url+"?q=make_task_active&taskid="+taskid+"&secid="+tsec+"&cat="+taskcat+"&type="+tasktype; 
		url=url+"&sid="+Math.random();
		xmlhttp.onreadystatechange=showactivetask;
		xmlhttp.open("GET",url,true);
		xmlhttp.send(null);
}
else{ alert("Please Choose a Task Section."); }
}

function showactivetask()
{

if (xmlhttp.readyState==4)
{
document.getElementById("active_area").innerHTML=xmlhttp.responseText;

}
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function make_task_inactive( hiliteid , taskid)
{
	var taskcat=document.getElementById('task_cat').value;
	var tsec = document.getElementById("get_tsec").value;
if(tsec != '') {

	xmlhttp=GetXmlHttpObject();
		if (xmlhttp==null)
  		{
  			alert ("Browser does not support HTTP Request");
  			return;
  		}
		var url="task_ajax_return.php";
		url=url+"?q=make_task_inactive&hid="+hiliteid+"&taskid="+taskid+"&secid="+tsec+"&cat="+taskcat; 
		url=url+"&sid="+Math.random();
		xmlhttp.onreadystatechange=showinactivetask;
		xmlhttp.open("GET",url,true);
		xmlhttp.send(null);
}
else{ alert("Please Choose a Task Section."); }
}

function showinactivetask()
{

if (xmlhttp.readyState==4)
{
document.getElementById("active_area").innerHTML=xmlhttp.responseText;

}
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function GetXmlHttpObject()
{
if (window.XMLHttpRequest)
  {
  // code for IE7+, Firefox, Chrome, Opera, Safari
  return new XMLHttpRequest();
  }
if (window.ActiveXObject)
  {
  // code for IE6, IE5
  return new ActiveXObject("Microsoft.XMLHTTP");
  }
return null;
}// JavaScript Document

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////